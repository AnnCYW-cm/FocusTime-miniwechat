<!-- pages/profile/profile.wxml -->
<view class="container">
  <!-- ç”¨æˆ·ä¿¡æ¯å¡ç‰‡ -->
  <view class="profile-card card">
    <!-- å·²ç™»å½•çŠ¶æ€ -->
    <view wx:if="{{userInfo.nickName}}" class="avatar-section">
      <image class="avatar" src="{{userInfo.avatarUrl || '/images/default-avatar.png'}}" mode="aspectFill"></image>
      <view class="user-info">
        <text class="nickname">{{userInfo.nickName}}</text>
        <text class="register-days">â° å·²ä½¿ç”¨ {{registerDays}} å¤©</text>
      </view>
    </view>

    <!-- æœªç™»å½•çŠ¶æ€ - ç™»å½•å¼•å¯¼ -->
    <view wx:else class="login-guide">
      <view class="login-icon">ğŸ‘‹</view>
      <view class="login-title">æ¬¢è¿ä½¿ç”¨ TimeFocus</view>
      <view class="login-desc">è®¾ç½®ä½ çš„å¤´åƒå’Œæ˜µç§°ï¼Œå¼€å§‹é«˜æ•ˆä¸“æ³¨ä¹‹æ—…</view>

      <view class="login-form">
        <button class="btn-avatar" open-type="chooseAvatar" bindchooseavatar="onChooseAvatar">
          <image wx:if="{{tempAvatar}}" class="preview-avatar" src="{{tempAvatar}}" mode="aspectFill"></image>
          <text wx:else class="avatar-placeholder">
            <text class="avatar-icon">ğŸ“·</text>
            <text class="avatar-text">ç‚¹å‡»é€‰æ‹©å¤´åƒ</text>
          </text>
        </button>

        <view class="input-wrapper">
          <text class="input-label">æ˜µç§°</text>
          <input class="input-nickname" type="nickname" placeholder="è¯·è¾“å…¥ä½ çš„æ˜µç§°" placeholder-style="line-height: 44rpx;" bindinput="onNicknameInput" value="{{tempNickname}}" />
        </view>

        <button wx:if="{{tempNickname}}" class="btn-save" bindtap="onSaveUserInfo">
          <text>âœ“ å®Œæˆè®¾ç½®</text>
        </button>
      </view>
    </view>
  </view>

  <!-- ç´¯è®¡æ•°æ® -->
  <view class="stats-card card">
    <view class="stats-title">ğŸ“Š ç´¯è®¡æ•°æ®</view>
    <view class="stats-grid">
      <view class="stat-box">
        <text class="stat-icon">ğŸ…</text>
        <text class="stat-number">{{cumulativeStats.totalPomodoros}}</text>
        <text class="stat-label">æ€»ç•ªèŒ„æ•°</text>
      </view>
      <view class="stat-box">
        <text class="stat-icon">â±</text>
        <text class="stat-number">{{cumulativeStats.totalHours}}</text>
        <text class="stat-label">æ€»æ—¶é•¿(å°æ—¶)</text>
      </view>
      <view class="stat-box">
        <text class="stat-icon">âœ…</text>
        <text class="stat-number">{{cumulativeStats.totalTasks}}</text>
        <text class="stat-label">å®Œæˆä»»åŠ¡</text>
      </view>
      <view class="stat-box">
        <text class="stat-icon">ğŸ“ˆ</text>
        <text class="stat-number">{{cumulativeStats.avgDaily}}</text>
        <text class="stat-label">æ—¥å‡ç•ªèŒ„</text>
      </view>
    </view>
  </view>

  <!-- åŠŸèƒ½èœå• -->
  <view class="menu-list">
    <view class="menu-item" bindtap="onGoToSettings">
      <view class="menu-left">
        <text class="menu-icon">âš™ï¸</text>
        <text class="menu-title">è®¾ç½®</text>
      </view>
      <text class="menu-arrow">â€º</text>
    </view>

    <view class="menu-item" bindtap="onAbout">
      <view class="menu-left">
        <text class="menu-icon">â„¹ï¸</text>
        <text class="menu-title">å…³äº</text>
      </view>
      <text class="menu-arrow">â€º</text>
    </view>
  </view>
</view>
